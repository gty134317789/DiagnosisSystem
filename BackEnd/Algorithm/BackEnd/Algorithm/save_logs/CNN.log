x_train的shape是：
(6270, 784)
x_valid的shape是：
(785, 784)
x_test的shape是：
(785, 784)
x_train的最大值和最小值： 18.53415386725727 -18.909235618455217
x_test的最大值和最小值： 15.46389257869479 -15.479637165290052
正在进行初始输入数据的可视化...
x_train.shape[1], x_train.shape[2]:
784 1
Model: "cnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 784, 1)]          0         
_________________________________________________________________
conv1d (Conv1D)              (None, 784, 8)            48        
_________________________________________________________________
max_pooling1d (MaxPooling1D) (None, 392, 8)            0         
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 392, 16)           400       
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 196, 16)           0         
_________________________________________________________________
flatten (Flatten)            (None, 3136)              0         
_________________________________________________________________
dropout (Dropout)            (None, 3136)              0         
_________________________________________________________________
dense (Dense)                (None, 32)                100384    
_________________________________________________________________
dense_1 (Dense)              (None, 10)                330       
=================================================================
Total params: 101,162
Trainable params: 101,162
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/25 [>.............................] - ETA: 11s - loss: 2.4753 - accuracy: 0.0586 3/25 [==>...........................] - ETA: 0s - loss: 2.3458 - accuracy: 0.0703  5/25 [=====>........................] - ETA: 0s - loss: 2.2878 - accuracy: 0.0797 7/25 [=======>......................] - ETA: 0s - loss: 2.2566 - accuracy: 0.0893 9/25 [=========>....................] - ETA: 0s - loss: 2.2340 - accuracy: 0.097711/25 [============>.................] - ETA: 0s - loss: 2.2081 - accuracy: 0.110413/25 [==============>...............] - ETA: 0s - loss: 2.1937 - accuracy: 0.123515/25 [=================>............] - ETA: 0s - loss: 2.1824 - accuracy: 0.132317/25 [===================>..........] - ETA: 0s - loss: 2.1679 - accuracy: 0.145919/25 [=====================>........] - ETA: 0s - loss: 2.1535 - accuracy: 0.157721/25 [========================>.....] - ETA: 0s - loss: 2.1433 - accuracy: 0.167023/25 [==========================>...] - ETA: 0s - loss: 2.1290 - accuracy: 0.174625/25 [==============================] - 1s 36ms/step - loss: 2.1172 - accuracy: 0.1821 - val_loss: 1.9321 - val_accuracy: 0.3261

Validation loss decreased from inf to 1.9320961236953735, saving model
Epoch 2/10
 1/25 [>.............................] - ETA: 0s - loss: 1.9033 - accuracy: 0.3164 3/25 [==>...........................] - ETA: 0s - loss: 1.8933 - accuracy: 0.3242 5/25 [=====>........................] - ETA: 0s - loss: 1.8863 - accuracy: 0.3234 7/25 [=======>......................] - ETA: 0s - loss: 1.8642 - accuracy: 0.3287 9/25 [=========>....................] - ETA: 0s - loss: 1.8598 - accuracy: 0.329011/25 [============>.................] - ETA: 0s - loss: 1.8561 - accuracy: 0.330313/25 [==============>...............] - ETA: 0s - loss: 1.8399 - accuracy: 0.336215/25 [=================>............] - ETA: 0s - loss: 1.8251 - accuracy: 0.341917/25 [===================>..........] - ETA: 0s - loss: 1.8125 - accuracy: 0.345819/25 [=====================>........] - ETA: 0s - loss: 1.8015 - accuracy: 0.352221/25 [========================>.....] - ETA: 0s - loss: 1.7805 - accuracy: 0.363123/25 [==========================>...] - ETA: 0s - loss: 1.7682 - accuracy: 0.371325/25 [==============================] - 1s 32ms/step - loss: 1.7536 - accuracy: 0.3767 - val_loss: 1.4780 - val_accuracy: 0.5338

Validation loss decreased from 1.9320961236953735 to 1.4779834747314453, saving model
Epoch 3/10
 1/25 [>.............................] - ETA: 0s - loss: 1.4890 - accuracy: 0.5156 3/25 [==>...........................] - ETA: 0s - loss: 1.4908 - accuracy: 0.4987 5/25 [=====>........................] - ETA: 0s - loss: 1.4405 - accuracy: 0.5133 7/25 [=======>......................] - ETA: 0s - loss: 1.4338 - accuracy: 0.5089 9/25 [=========>....................] - ETA: 0s - loss: 1.4314 - accuracy: 0.509111/25 [============>.................] - ETA: 0s - loss: 1.4182 - accuracy: 0.514913/25 [==============>...............] - ETA: 0s - loss: 1.3945 - accuracy: 0.526115/25 [=================>............] - ETA: 0s - loss: 1.3782 - accuracy: 0.532817/25 [===================>..........] - ETA: 0s - loss: 1.3626 - accuracy: 0.538119/25 [=====================>........] - ETA: 0s - loss: 1.3478 - accuracy: 0.542621/25 [========================>.....] - ETA: 0s - loss: 1.3334 - accuracy: 0.546723/25 [==========================>...] - ETA: 0s - loss: 1.3165 - accuracy: 0.550425/25 [==============================] - 1s 32ms/step - loss: 1.3034 - accuracy: 0.5542 - val_loss: 1.0929 - val_accuracy: 0.6217

Validation loss decreased from 1.4779834747314453 to 1.0929034948349, saving model
Epoch 4/10
 1/25 [>.............................] - ETA: 0s - loss: 1.1656 - accuracy: 0.5898 3/25 [==>...........................] - ETA: 0s - loss: 1.1389 - accuracy: 0.6094 5/25 [=====>........................] - ETA: 0s - loss: 1.1003 - accuracy: 0.6203 7/25 [=======>......................] - ETA: 0s - loss: 1.0866 - accuracy: 0.6200 9/25 [=========>....................] - ETA: 0s - loss: 1.0726 - accuracy: 0.621111/25 [============>.................] - ETA: 0s - loss: 1.0629 - accuracy: 0.632813/25 [==============>...............] - ETA: 0s - loss: 1.0555 - accuracy: 0.640015/25 [=================>............] - ETA: 0s - loss: 1.0365 - accuracy: 0.646417/25 [===================>..........] - ETA: 0s - loss: 1.0112 - accuracy: 0.653319/25 [=====================>........] - ETA: 0s - loss: 0.9968 - accuracy: 0.658321/25 [========================>.....] - ETA: 0s - loss: 0.9776 - accuracy: 0.666923/25 [==========================>...] - ETA: 0s - loss: 0.9624 - accuracy: 0.673625/25 [==============================] - 1s 32ms/step - loss: 0.9501 - accuracy: 0.6801 - val_loss: 0.7912 - val_accuracy: 0.7694

Validation loss decreased from 1.0929034948349 to 0.7912030816078186, saving model
Epoch 5/10
 1/25 [>.............................] - ETA: 0s - loss: 0.7569 - accuracy: 0.7656 3/25 [==>...........................] - ETA: 0s - loss: 0.7715 - accuracy: 0.7539 5/25 [=====>........................] - ETA: 0s - loss: 0.7688 - accuracy: 0.7555 7/25 [=======>......................] - ETA: 0s - loss: 0.7581 - accuracy: 0.7600 9/25 [=========>....................] - ETA: 0s - loss: 0.7489 - accuracy: 0.764811/25 [============>.................] - ETA: 0s - loss: 0.7293 - accuracy: 0.776313/25 [==============>...............] - ETA: 0s - loss: 0.7078 - accuracy: 0.791515/25 [=================>............] - ETA: 0s - loss: 0.6958 - accuracy: 0.798217/25 [===================>..........] - ETA: 0s - loss: 0.6842 - accuracy: 0.803319/25 [=====================>........] - ETA: 0s - loss: 0.6706 - accuracy: 0.808621/25 [========================>.....] - ETA: 0s - loss: 0.6661 - accuracy: 0.811023/25 [==========================>...] - ETA: 0s - loss: 0.6550 - accuracy: 0.813925/25 [==============================] - ETA: 0s - loss: 0.6510 - accuracy: 0.815825/25 [==============================] - 1s 37ms/step - loss: 0.6510 - accuracy: 0.8158 - val_loss: 0.5626 - val_accuracy: 0.8548

Validation loss decreased from 0.7912030816078186 to 0.5625844597816467, saving model
Epoch 6/10
 1/25 [>.............................] - ETA: 0s - loss: 0.4895 - accuracy: 0.8828 3/25 [==>...........................] - ETA: 0s - loss: 0.5123 - accuracy: 0.8672 5/25 [=====>........................] - ETA: 0s - loss: 0.5118 - accuracy: 0.8695 7/25 [=======>......................] - ETA: 0s - loss: 0.5082 - accuracy: 0.8638 9/25 [=========>....................] - ETA: 0s - loss: 0.4998 - accuracy: 0.863711/25 [============>.................] - ETA: 0s - loss: 0.5028 - accuracy: 0.864713/25 [==============>...............] - ETA: 0s - loss: 0.4968 - accuracy: 0.867215/25 [=================>............] - ETA: 0s - loss: 0.4909 - accuracy: 0.869317/25 [===================>..........] - ETA: 0s - loss: 0.4848 - accuracy: 0.870419/25 [=====================>........] - ETA: 0s - loss: 0.4786 - accuracy: 0.871321/25 [========================>.....] - ETA: 0s - loss: 0.4733 - accuracy: 0.873923/25 [==========================>...] - ETA: 0s - loss: 0.4675 - accuracy: 0.875725/25 [==============================] - 1s 32ms/step - loss: 0.4644 - accuracy: 0.8756 - val_loss: 0.3846 - val_accuracy: 0.9248

Validation loss decreased from 0.5625844597816467 to 0.3845509886741638, saving model
Epoch 7/10
 1/25 [>.............................] - ETA: 0s - loss: 0.3546 - accuracy: 0.9297 3/25 [==>...........................] - ETA: 0s - loss: 0.3767 - accuracy: 0.9062 5/25 [=====>........................] - ETA: 0s - loss: 0.3783 - accuracy: 0.9023 7/25 [=======>......................] - ETA: 0s - loss: 0.3788 - accuracy: 0.9051 9/25 [=========>....................] - ETA: 0s - loss: 0.3709 - accuracy: 0.906711/25 [============>.................] - ETA: 0s - loss: 0.3691 - accuracy: 0.908413/25 [==============>...............] - ETA: 0s - loss: 0.3720 - accuracy: 0.906915/25 [=================>............] - ETA: 0s - loss: 0.3687 - accuracy: 0.906817/25 [===================>..........] - ETA: 0s - loss: 0.3651 - accuracy: 0.906519/25 [=====================>........] - ETA: 0s - loss: 0.3602 - accuracy: 0.907521/25 [========================>.....] - ETA: 0s - loss: 0.3559 - accuracy: 0.908723/25 [==========================>...] - ETA: 0s - loss: 0.3540 - accuracy: 0.907325/25 [==============================] - 1s 32ms/step - loss: 0.3525 - accuracy: 0.9080 - val_loss: 0.2989 - val_accuracy: 0.9287

Validation loss decreased from 0.3845509886741638 to 0.29892367124557495, saving model
Epoch 8/10
 1/25 [>.............................] - ETA: 0s - loss: 0.2684 - accuracy: 0.9414 3/25 [==>...........................] - ETA: 0s - loss: 0.2885 - accuracy: 0.9219 5/25 [=====>........................] - ETA: 0s - loss: 0.3030 - accuracy: 0.9180 7/25 [=======>......................] - ETA: 0s - loss: 0.3034 - accuracy: 0.9185 9/25 [=========>....................] - ETA: 0s - loss: 0.3018 - accuracy: 0.920611/25 [============>.................] - ETA: 0s - loss: 0.2990 - accuracy: 0.922213/25 [==============>...............] - ETA: 0s - loss: 0.2942 - accuracy: 0.925215/25 [=================>............] - ETA: 0s - loss: 0.2917 - accuracy: 0.925017/25 [===================>..........] - ETA: 0s - loss: 0.2928 - accuracy: 0.922819/25 [=====================>........] - ETA: 0s - loss: 0.2907 - accuracy: 0.922721/25 [========================>.....] - ETA: 0s - loss: 0.2896 - accuracy: 0.923423/25 [==========================>...] - ETA: 0s - loss: 0.2895 - accuracy: 0.922925/25 [==============================] - 1s 33ms/step - loss: 0.2888 - accuracy: 0.9222 - val_loss: 0.2588 - val_accuracy: 0.9274

Validation loss decreased from 0.29892367124557495 to 0.25877293944358826, saving model
Epoch 9/10
 1/25 [>.............................] - ETA: 0s - loss: 0.2282 - accuracy: 0.9375 3/25 [==>...........................] - ETA: 0s - loss: 0.2586 - accuracy: 0.9219 5/25 [=====>........................] - ETA: 0s - loss: 0.2500 - accuracy: 0.9297 7/25 [=======>......................] - ETA: 0s - loss: 0.2544 - accuracy: 0.9308 9/25 [=========>....................] - ETA: 0s - loss: 0.2555 - accuracy: 0.930611/25 [============>.................] - ETA: 0s - loss: 0.2511 - accuracy: 0.933613/25 [==============>...............] - ETA: 0s - loss: 0.2488 - accuracy: 0.934815/25 [=================>............] - ETA: 0s - loss: 0.2438 - accuracy: 0.937517/25 [===================>..........] - ETA: 0s - loss: 0.2407 - accuracy: 0.938919/25 [=====================>........] - ETA: 0s - loss: 0.2373 - accuracy: 0.940421/25 [========================>.....] - ETA: 0s - loss: 0.2374 - accuracy: 0.939223/25 [==========================>...] - ETA: 0s - loss: 0.2357 - accuracy: 0.939525/25 [==============================] - ETA: 0s - loss: 0.2354 - accuracy: 0.939925/25 [==============================] - 1s 33ms/step - loss: 0.2354 - accuracy: 0.9399 - val_loss: 0.2297 - val_accuracy: 0.9427

Validation loss decreased from 0.25877293944358826 to 0.22971993684768677, saving model
Epoch 10/10
 1/25 [>.............................] - ETA: 0s - loss: 0.1821 - accuracy: 0.9570 3/25 [==>...........................] - ETA: 0s - loss: 0.2070 - accuracy: 0.9505 5/25 [=====>........................] - ETA: 0s - loss: 0.2130 - accuracy: 0.9445 7/25 [=======>......................] - ETA: 0s - loss: 0.2121 - accuracy: 0.9470 9/25 [=========>....................] - ETA: 0s - loss: 0.2073 - accuracy: 0.948811/25 [============>.................] - ETA: 0s - loss: 0.2081 - accuracy: 0.949613/25 [==============>...............] - ETA: 0s - loss: 0.2060 - accuracy: 0.950115/25 [=================>............] - ETA: 0s - loss: 0.2083 - accuracy: 0.947917/25 [===================>..........] - ETA: 0s - loss: 0.2081 - accuracy: 0.945319/25 [=====================>........] - ETA: 0s - loss: 0.2066 - accuracy: 0.945921/25 [========================>.....] - ETA: 0s - loss: 0.2091 - accuracy: 0.944423/25 [==========================>...] - ETA: 0s - loss: 0.2060 - accuracy: 0.945025/25 [==============================] - ETA: 0s - loss: 0.2072 - accuracy: 0.944025/25 [==============================] - 1s 33ms/step - loss: 0.2072 - accuracy: 0.9440 - val_loss: 0.1799 - val_accuracy: 0.9643

Validation loss decreased from 0.22971993684768677 to 0.17985345423221588, saving model
 1/25 [>.............................] - ETA: 4s - loss: 0.2410 - accuracy: 0.875018/25 [====================>.........] - ETA: 0s - loss: 0.1998 - accuracy: 0.935825/25 [==============================] - 0s 3ms/step - loss: 0.1902 - accuracy: 0.9414
评估完成
accuracy: 94.14%
[8 6 7 0 7]
              precision    recall  f1-score   support

           0     0.7980    1.0000    0.8876        79
           1     1.0000    0.7215    0.8382        79
           2     0.7708    0.9487    0.8506        78
           3     1.0000    1.0000    1.0000        78
           4     1.0000    0.7722    0.8714        79
           5     1.0000    1.0000    1.0000        78
           6     1.0000    1.0000    1.0000        79
           7     0.9500    0.9744    0.9620        78
           8     1.0000    1.0000    1.0000        79
           9     1.0000    1.0000    1.0000        78

    accuracy                         0.9414       785
   macro avg     0.9519    0.9417    0.9410       785
weighted avg     0.9519    0.9414    0.9409       785

 1/25 [>.............................] - ETA: 0s18/25 [====================>.........] - ETA: 0s25/25 [==============================] - 0s 3ms/step
785
[[79  0  0  0  0  0  0  0  0  0]
 [20 57  2  0  0  0  0  0  0  0]
 [ 0  0 74  0  0  0  0  4  0  0]
 [ 0  0  0 78  0  0  0  0  0  0]
 [ 0  0 18  0 61  0  0  0  0  0]
 [ 0  0  0  0  0 78  0  0  0  0]
 [ 0  0  0  0  0  0 79  0  0  0]
 [ 0  0  2  0  0  0  0 76  0  0]
 [ 0  0  0  0  0  0  0  0 79  0]
 [ 0  0  0  0  0  0  0  0  0 78]]
[t-SNE] Computing 91 nearest neighbors...
[t-SNE] Indexed 785 samples in 0.001s...
[t-SNE] Computed neighbors for 785 samples in 0.017s...
[t-SNE] Computed conditional probabilities for sample 785 / 785
[t-SNE] Mean sigma: 0.000217
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.713306
[t-SNE] KL divergence after 1000 iterations: 0.112666
No handles with labels found to put in legend.
{'num_classes': 5, 'epochs': 10, 'number': 100, 'train': 0.8, 'valid': 0.1, 'test': 0.1, 'check': False, 'model': 'INCEPTION'}
